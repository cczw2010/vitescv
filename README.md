åŸºäºvite,vu2.7çš„ vueå•æ–‡ä»¶ç»„ä»¶å¼€å‘æ¨¡å¼æ¸²æŸ“å°è„šæ‰‹æ¶(CSR)ï¼Œ æ”¯æŒè‡ªå®šä¹‰æ¨¡å—,æ”¯æŒè‡ªåŠ¨ç»„ä»¶åŠ è½½.

### ä½¿ç”¨

**è¯·ä½¿ç”¨`pnpm`ç®¡ç†åŒ…**
```js
// ##########å®‰è£…
pnpm install vitescv

// ##########åˆå§‹åŒ–é¡¹ç›®
npx vitescv init

// ##########å¼€å‘æ¨¡å¼
npx vitescv [dev]

// ##########ç¼–è¯‘
npx vitescv build

// ##########é¢„è§ˆ
npx vitescv preview

æ›´å¥½çš„ä½¿ç”¨æ–¹å¼æ˜¯åœ¨`package.json`ä¸­è®¾ç½®ä¸ºnpmå‘½ä»¤:

"scripts": {
  "dev": "npx vitescv dev ",
  "build": "npx vitescv build",
  "preview": "npx vitescv preview"
},

```
### é…ç½®

åˆå§‹åŒ–ä¹‹åï¼Œä¼šåœ¨ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶å¿«æ·æ–¹å¼`config.js`,`index.html`ã€‚å‰è€…æ˜¯é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œåè€…æ˜¯viteçš„index.htmlæ¨¡æ¿æ–‡ä»¶ã€‚å¯è‡ªè¡Œé…ç½®

```js
## config.js
/****************** viteéƒ¨åˆ† *******************/
host:'127.0.0.1',                        //host
port:xx,                                 //port
source:"view",                           // vueé¡¹ç›®çš„æºç ç›®å½•
outDir:'dist',                           // æ‰“åŒ…è¾“å‡ºæ ¹è·¯å¾„
// ç¼–è¯‘æ—¶çš„å…¼å®¹è®¾ç½®ï¼Œè®¾ç½®ä¸ºfalseå¯å…³é—­ã€‚å…·ä½“å‚è€ƒ@vitejs/plugin-legacyçš„å‚æ•°è®¾ç½®
legacy:{},
//ç¼–è¯‘è¿‡ç¨‹æ§åˆ¶ æŒ‰éœ€å¼•å…¥ç¬¬ä¸‰æ–¹UIåº“ï¼Œå‚è€ƒï¼šunplugin-vue-components/resolvers
UIResolvers:{
  "ElementUiResolver":{importStyle:true},
},
// å¼ºåˆ¶å¤–éƒ¨åŒ–çš„åº“
external:['vue'],                         //æ‰“åŒ…æ—¶å¼ºåˆ¶å¤–éƒ¨åŒ–çš„åº“ï¼Œé»˜è®¤ç©º
/****************** è‡ªå®šä¹‰éƒ¨åˆ† *******************/
//å…¨å±€è·¯ç”±ä¸­é—´ä»¶ ï¼Œåº”ç”¨äºæ‰€æœ‰è·¯ç”±
middlewares:['view/middlewares/xxx.js'],
//è‡ªå®šä¹‰æ¨¡å—
modules:[
  "@vitescv/i18n":{
    ...options
  },
],
// è·¯ç”±ç›¸å…³  @ä»£è¡¨é¡¹ç›®æ ¹ç›®å½•
componentLoading:'@/view/components/loading.vue',  //è·¯ç”±åŠ¨æ€åŠ è½½æ—¶çš„loadingç»„ä»¶ï¼ŒAppLoading é¢„è®¾
componentError:'@/view/components/xx.vue',             //è·¯ç”±åŠ¨æ€åŠ è½½é”™è¯¯æ—¶æ˜¾ç¤ºç»„ä»¶ï¼ŒAppError é¢„è®¾
compomentRouteView:'@/view/components/xx.vue',         //è·¯ç”±é¡µé¢æ˜¾ç¤ºç»„ä»¶ï¼ŒAppView é¢„è®¾
page404:'/404',                 //404é¡µé¢
```

### ç¯å¢ƒå˜é‡

å¯ä»¥é€šè¿‡ä¸åŒæ¨¡å¼çš„`.env*`æ–‡ä»¶å®ç°ä¸åŒç¯å¢ƒå’Œæ¨¡å¼çš„ç¯å¢ƒå˜é‡è®¾ç½®,å¹¶åœ¨ä»£ç ä¸­å¯é€šè¿‡`import.meta.env`æ¥è®¿é—®ã€‚å…·ä½“å‚è€ƒVITEçš„[ç¯å¢ƒå˜é‡å’Œæ¨¡å¼](https://cn.vitejs.dev/guide/env-and-mode.html)


### ç›®å½•ï¼š

```js
// åº”ç”¨éƒ¨åˆ†
.vitescv          #vitescvè¿è¡Œæ—¶æ–‡ä»¶å¤¹
config.js         #vitescvé…ç½®æ–‡ä»¶
.env*             #ç”¨æˆ·è‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡,å‚è€ƒvite

view/pages        #é¡µé¢ç›®å½•
view/layouts      #layoutç›®å½•
view/components   #è‡ªåŠ¨åŠ è½½çš„å•æ–‡ä»¶ç»„ä»¶è·¯å¾„
view/middlewares  #è‡ªåŠ¨åŠ è½½çš„è·¯ç”±middleware

```

### page

vueçš„sfcæ–‡ä»¶ï¼Œæ–‡ä»¶è·¯å¾„åˆ™æ˜¯è·¯ç”±è®¿é—®è·¯å¾„

```js
<template>
...
</template>
<script>
export default {
  ...
  // ç»™è·¯ç”±å‘½å
  name:'home',
  // è®¾ç½®è·¯ç”±åˆ«åè®¿é—®è·¯å¾„
  alias:'/home',
  // headç›¸å…³æ³¨å…¥è®¾ç½®ï¼Œå‚è€ƒvue-meta
  head:{...},
  // è®¾å®šè¯¥é¡µé¢çš„å¸ƒå±€æ–‡ä»¶åï¼Œé»˜è®¤`default`, å¯¹åº”layoutç›®å½•ä¸­çš„ `default.vue`
  layout:'default',
}
</script>
```
>å¦å¤–ï¼Œç”¨æˆ·å…¶ä»–è‡ªå®šä¹‰å­—é¢é‡å±æ€§[string|boolean|null|reg]ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯»å–å¹¶é¢„è®¾è¿›é¡µé¢è·¯ç”±æ‰€åœ¨metaä¸­ï¼Œæ–¹ä¾¿æ‰©å±•æ¨¡å—æˆ–è€…ä¸­é—´ä»¶
eg:
```js
//page.vue
<script>
...
data(){...}
// è‡ªå®šä¹‰å­—é¢é‡å±æ€§,å¯åœ¨è·¯ç”±çš„metaä¸­è®¿é—®
auth:false,
topinfo:'welcome new user',
...
created(){
  ...
}
</script>
```

### layout

ä¸æ”¯æŒå¤šçº§ç›®å½•ï¼Œè‡ªåŠ¨æ ¹æ®`page`çš„è®¾å®šåŠ è½½ã€‚  å†…éƒ¨ä½¿ç”¨ `app-view` ç»„ä»¶æŒ‡å®šé¡µé¢æ¸²æŸ“çš„ä½ç½®ã€‚å¹¶ä¸”åœ¨è·³è½¬çš„åœ°æ–¹éœ€è¦
å¯ä»¥å¢åŠ `transition`æˆ–è€…`keep-alive` æ¥å®šåˆ¶æ˜¾ç¤ºæ•ˆæœã€‚

```js
<template>
  ...
  <transition name="fade" mode="out-in" appear>
    <keep-alive>
    <app-view></app-view>
    </keep-alive>
  </transition>
  ...
</template>
<script>
export default {
  // headç›¸å…³æ³¨å…¥è®¾ç½®ï¼Œå‚è€ƒvue-meta
  head,
 ...
}
</script>
```


### component
è‡ªå®šä¹‰çš„ç»„ä»¶ç›®å½•ä¸­çš„å•æ–‡ä»¶ç»„ä»¶åœ¨é¡µé¢æˆ–è€…layoutä¸­æ— éœ€å¼•å…¥ï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼Œå°†è‡ªåŠ¨è¢«åŠ è½½å¼•ç”¨ã€‚åŸºäº[unplugin-vue-components]å®ç°ã€‚ ç¬¬ä¸‰æ–¹çš„UIç»„ä»¶å¯å‚è€ƒ`è‡ªå®šä¹‰module`å®ç°

### metaInfo

åŸºäº`vue-meta`é€šè¿‡ç»„ä»¶ä¸­çš„`head`å±æ€§æ ‡ç­¾ï¼Œå®ç°äº†é¡µé¢çš„åŸºç¡€ä¿¡æ¯ç®¡ç†ï¼ˆtitle,meta,link,style,script....ï¼‰ï¼Œ`page`ä¸­çš„é…ç½®ä¼šè¦†ç›–`layout`ä¸­çš„é…ç½®.

```js
export default {
  head(){
    // å‡½æ•°æ–¹å¼å¯ä»¥ä½¿ç”¨ç»„ä»¶çš„ä¸Šä¸‹æ–‡`this`
    return {
      title:this.title
    }
  }
}
```

### router

é›†æˆ`vue-router`ç®¡ç†è·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç»“æ„ç”Ÿæˆè·¯ç”±åœ°å€ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†ç®€åŒ–ä½¿ç”¨åŠä¸ªäººä¹ æƒ¯ï¼Œå¹¶æ²¡æœ‰å®ç°è‡ªå®šä¹‰åµŒå¥—è·¯ç”±ã€‚

`layout`ä¸­é€šè¿‡`app-view`æŒ‡å®šé¡µé¢æ¸²æŸ“çš„ä½ç½®,å†é€šè¿‡`router-link`ç»„ä»¶æ¥å®ç°é¡µé¢è·³è½¬ã€‚

ç›®å½•ä¸‹`index.vue`ä¸ºå½“å‰é»˜è®¤è·¯ç”±ï¼Œå¦å¤–å¯ä»¥é€šè¿‡æ–‡ä»¶å¤¹æˆ–è€…æ–‡ä»¶å¢åŠ `_`å‰ç¼€æ¥å®ç°åŠ¨æ€è·¯ç”±åŒ¹é…ã€‚ 

é¡µé¢ä¸Šå¯ä»¥ä½¿ç”¨routerçš„å±æ€§æ¥è®¿é—® `$route.query`å’Œ`$route.params`

```
## files in [sourceRoot]/pages ##
user/index.vue          # /user   or  /user/index
user/_id.vue            # /user/:id
user/_id/posts.vue      # /user/:id/posts
```


### è‡ªå®šä¹‰ç¼–è¯‘æ¨¡å—

å…¨å±€å¯ç¼–è¯‘vue moduleæ¨¡å—åŠ è½½ï¼Œåœ¨appåˆ›å»ºæœŸé—´è°ƒç”¨ï¼Œå¯ç”¨äºåŠ è½½ä¸€äº›å®šåˆ¶çš„æ¨¡å—åˆå§‹åŒ–ã€‚ï¼ˆå¼€å‘ç¬¬ä¸‰æ–¹åŒ…è¿‡ç¨‹ä¸­viteçš„ä¾èµ–ä¼˜åŒ–é€‰é¡¹å¼•å‘äº†å¤ªå¤šé—®é¢˜ï¼Œæ‰€ä»¥ç›´æ¥å…³äº†ï¼‰

æ¨¡å—é»˜è®¤è¿”å›åˆå§‹åŒ–æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å—ç”¨æˆ·è®¾ç½®å‚æ•°å¯¹è±¡ï¼Œå’Œä¸€ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡`context` ,å¯åœ¨åº”ç”¨è¿è¡Œç”Ÿå‘½å‘¨æœŸæ³¨å†Œé’©å­å‡½æ•°ã€‚å¯å‚è€ƒæºç ä¸­`@vitescv/i18n` å’Œ `@vitescv/element-ui`æ¨¡å—ã€‚
* **`é’©å­å‡½æ•°`**
  ç”¨æˆ·å¯ä»¥åœ¨æ¨¡å—åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œä½¿ç”¨é’©å­æ¥æ³¨å†Œåº”ç”¨ä¸åŒé˜¶æ®µçš„å¤„ç†ä»£ç 

  * **[APP:INIT]** 
  è¯¥é’©å­è¿è¡Œäº`app`ï¼ˆVueå®ä¾‹)åˆå§‹åŒ–ä¹‹å‰ï¼Œå¯ä»¥åšä¸€äº›é¢„å¤„ç†ï¼Œé’©å­çš„å›è°ƒå‡½æ•°å¾—åˆ°ä¸€ä¸ª`options`å¯¹è±¡çš„å¼•ç”¨ä½œä¸ºå‚æ•°ï¼Œå¯ä»¥ç›´æ¥æ‰©å±•è¯¥å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„æ‰€æœ‰å±æ€§å°†æ‰©å……åˆå¹¶åˆ°`app`åˆå§‹åŒ–å‚æ•°ï¼ˆnew Vue({...options})ï¼‰ã€‚å…¶ä¸­`mixin`æˆ–è€…`mixins`ä¼šè‡ªåŠ¨æ‰©å……åˆå¹¶åˆ°åˆå§‹åŒ–å‚æ•°çš„`mixins`æ•°ç»„ä¸­ï¼Œå…¶ä»–çš„ä¼šç›´æ¥è¦†ç›–åˆå¹¶ï¼Œè¯·æ³¨æ„ä¸è¦éšæ„å¢åŠ å‚æ•°ï¼Œä»¥é˜²å½±å“å…¶ä»–æ¨¡å—ã€‚
  æ­¤æ—¶ä¸Šä¸‹æ–‡ä¸­çš„`app`ï¼ˆVueå®ä¾‹ï¼‰è™½ç„¶è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œä½†æ˜¯`router`å·²ç»åˆå§‹åŒ–å®Œæ¯•
  * **[APP:CREATED]**
  è¯¥é’©å­è¿è¡Œäº`app`(Vueå®ä¾‹)åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œæ‰€ä»¥æ­¤æ—¶ä¸Šä¸‹æ–‡ä¸­çš„`app`å·²ç»å­˜åœ¨.

* **`Context`**

  è‡ªå®šä¹‰çš„æ¨¡å—åˆå§‹åŒ–å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œç¬¬äºŒä¸ªæ˜¯åº”ç”¨çš„ä¸Šä¸‹æ–‡`context`, è¿™ä¸ªå¯¹è±¡ä¸­åŒ…å«ä»¥ä¸‹å±æ€§å’Œæ–¹æ³•ï¼š

  - **app**

    è¯¥å¯¹è±¡æ˜¯é¡¹ç›®çš„Vueå®ä¾‹ï¼Œåœ¨`APP:CREATED`é’©å­ä¹‹åæ‰æœ‰æ•ˆ

  - **router**

    è¯¥å¯¹è±¡æ˜¯é¡¹ç›®çš„routerå®ä¾‹

  - **hook(lifecycle,function)**

    è¯¥æ–¹æ³•æ˜¯æ³¨å†Œé’©å­å‡½æ•°çš„æ–¹æ³•ï¼Œæ¨¡å—å¯ä»¥æ³¨å†Œè‡ªå·±çš„è¿è¡Œä»£ç åˆ°ä¸åŒçš„é¡¹ç›®è¿è¡Œé˜¶æ®µ

  

  å¦‚æœä½ æƒ³åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸæä¾›äº›å…¨å±€çš„æ–¹æ³•ç»™å…¶å®ƒæ¨¡å—ä½¿ç”¨ï¼Œæ‰©å……contextçš„å±æ€§æ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œä½†æ³¨æ„åƒä¸‡åˆ«å’Œé¢„è®¾çš„å±æ€§å†²çªï¼Œä¸ç„¶ä¼šæ˜¯ç¾éš¾æ€§çš„

  

* **`é«˜çº§å®šåˆ¶æ¨¡å—`**
  æ¨¡å—æ–‡ä»¶å¯ä»¥æ˜¯ç”¨æ¨¡æ¿è¯­æ³•ï¼Œå†…éƒ¨å¯ä»¥ä½¿ç”¨æ¨¡æ¿è¯­æ³•è‡ªå®šä¹‰åŠ¨æ€è¾“å‡º. ç³»ç»Ÿä¼šåœ¨ç¼–è¯‘é˜¶æ®µå¤„ç†æ¨¡æ¿ï¼Œè¿”å›çœŸæ­£çš„æ¨¡å—ã€‚ æ¨¡æ¿ä¸­åŒ…å«ä¸¤ä¸ªåˆå§‹åŒ–å¯¹è±¡:

  * **cwd** 		          ä»£è¡¨é¡¹ç›®æ ¹ç›®å½•(process.cwd())
  * **option**            å¯¹è±¡æ˜¯æ¨¡å—çš„è‡ªå®šä¹‰ä¼ å…¥çš„å‚æ•°å¯¹è±¡,æ–¹ä¾¿å®šåˆ¶åŠ¨æ€ä»£ç 
  * **utils**             å¯¹æ¨¡æ¿å†…æä¾›äº†ä¸€äº›å¸¸ç”¨å‡½æ•°å·¥å…·
  * **utils.normalPath**  viteçš„apiï¼Œç”¨äºå¿«å¹³å°å¤„ç†urlåœ°å€
  * **utils.resolve**     pathçš„api

ä»¥ä¸‹ç¤ºä¾‹å‚è€ƒ`@vitescv/i18n`çš„éƒ¨åˆ†ä»£ç 

```js
//ğŸ’¡ ä¸»æ–‡ä»¶ modules/xxx/index.js
import Vue from "vue"
import VueI18n from 'vue-i18n'
import jsondata from <%=utils.normalPath(utils.resolve(option.jsonUrl))%>
Vue.use(VueI18n)

const lang = '<%=option.lang%>'
const i18n = new VueI18n({...})
// å¯¼å‡ºé»˜è®¤åˆå§‹åŒ–æ–¹æ³•ï¼Œè¿”å›mixin
export default function(option,context){
  ...
  #1 æ³¨å†Œåº”ç”¨åˆ›å»ºå‰çš„åˆå§‹åŒ–é’©å­ï¼Œoptionså‚æ•°æœ€ç»ˆå°†åˆå¹¶åˆ°Vueå®ä¾‹çš„åˆ›å»ºå±æ€§é‡Œï¼Œ
  context.hook("APP:INIT",function(options) {
    options.i18n = i18n
    options.mixin = {
      ...
    }
  })
  #æ³¨å†Œappåˆå§‹åŒ–ä¹‹åçš„é’©å­
  context.hook("APP:CREATED",function() {
  	context.app ...
  })

}
```
æ¨¡å—æ”¯æŒæœ‰é™çš„ä¿®æ”¹ç”¨æˆ·é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œå­—éœ€è¦åœ¨åŒç›®å½•ä¸‹éœ€è¦æä¾›ä¸€ä¸ª`config.js` ,å¦‚æœæ˜¯packageè¿˜éœ€è¦å†`package.json`ä¸­è®¾å®š.
```js
//ğŸ’¡ modules/xxx/config.js
export default {
  // ğŸ’¡unplugin-vue-components/vite  dirsé¡¹
  UIDirs:[],
  // ğŸ’¡unplugin-vue-components/vite  resolversé¡¹,ï¼ï¼ï¼ä¸é¡¹ç›®config.jsä¸­ä¸åŒçš„æ˜¯ï¼Œ
  //   è¿™é‡Œå¯ä»¥æ˜¯ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•(ï¼æ³¨æ„è¯¥æ–¹æ³•ä¸æ˜¯unplugin-vue-componentsçš„resolversçš„æ„é€ å‡½æ•°)ï¼Œ
  //   [modules]æ¨¡å—é…ç½®ä¸­çš„resolverå±æ€§ä¼šå½“åšé…ç½®ä¿¡æ¯æ³¨å…¥åˆ°è¯¥æ–¹æ³•é‡Œï¼Œæ–¹ä¾¿å®šåˆ¶åŒ–
  UIResolvers:[
    function(option){
      return xxxUiResolver(Object.assign({
        importStyle:true,
      },option))
    },
    {
      type: "component",
      resolve: (name) => {
        ...
        return ...
      }
    }
  ],
 // ğŸ’¡ ä»¥ä¸‹ä¸¤é¡¹åˆ†åˆ«å¯¹åº”viteé…ç½®ä¸­çš„: build.commonjsOptions.input å’Œ optimizeDeps.input   ä»…åœ¨å¼€å‘æ¨¡å¼ç”Ÿæ•ˆ, ä½†æ˜¯vitejsçš„é¢„æ„å»ºä¼šå¼•èµ·ä¸€äº›é—®é¢˜ï¼Œæˆ–è€…devå’Œbuildå·®å¼‚ï¼Œå°½é‡ä¸è¦ä½¿ç”¨
  buildCommonjsInclude:['packagename'],
  optimizeDepsInput:['packagename'],
  // ğŸ’¡ å¤–éƒ¨åŒ–çš„åŒ…
  external:[],
  // ğŸ’¡ æ‰©å±•vite.config.jsçš„rollupOptions.output.manualChunksè®¾ç½®é¡¹
  manualChunks:{},
}

//ğŸ’¡ å¦‚æœæ˜¯packageå®‰è£…åŒ…ï¼Œè¿˜éœ€è¦å†package.jsonä¸­è®¾å®šã€‚
{
  exports:{
    ".": "./index.js",						//æœ‰exportså°±å¿…é¡»ï¼Œå› ä¸ºæœ‰exportsåï¼Œè§£ææ¨¡å—åœ°å€æ—¶mainä¼šè«åå¤±æ•ˆ
    "./config": "./config.js",		
  }
}

```

è§£é‡Šä¸€ä¸‹ï¼Œä»¥ä¸Šç¤ºä¾‹ï¼Œå®é™…çš„åº”ç”¨ä¸­çš„æ•ˆæœç­‰åŒäºåœ¨appåˆ›å»ºæ—¶ï¼š
```js
new Vue({
  i18n,
  mixins:[mixin]
})
```

ç”¨æˆ·ä½¿ç”¨çš„æ—¶å€™åªéœ€åœ¨é¡¹ç›®çš„é…ç½®æ–‡ä»¶`config.js`ä¸­è®¾ç½®

```js
modules:{
  '@/modules/xxx/index.js':{...},
}

```



ç›®å‰çš„ä¸€äº›æ¨¡å—åˆ—è¡¨ï¼š

[@vitescv/i18n](./packages/i18n)

[@vitescv/vuemeta](./packages/vuemeta)

[@vitescv/elementui](./packages/elementui)

[@vitescv/vuetify](./packages/vuetify)

[@vitescv/pinia](./packages/pinia)

### TODO ä¸­é—´ä»¶Middleware

vueçš„è·¯ç”±ä¸­é—´ä»¶ï¼ˆè·¯ç”±å®ˆå«ï¼‰ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹æ‰€æœ‰é¡µé¢ç”Ÿæ•ˆçš„å…¨å±€`beforeEach`è·¯ç”±å®ˆå«: 
**CSR**:å®¢æˆ·ç«¯åˆå§‹åŒ–å’Œæ¯æ¬¡é¡µé¢è·¯ç”±éƒ½ä¼šæ‰§è¡Œ

*  è·¯ç”±æ–‡ä»¶

```js

export default function({to,from,next,store,router}){
  <!-- ä½œä¸ºå®ˆå«æ‰§è¡Œï¼Œæ‰€ä»¥å¿…é¡»æ‰§è¡Œnextæ–¹æ³•æ¥å†³å®šè·¯ç”±çš„æ‰§è¡Œæƒ…å†µ -->
  if(....){
    return next('/login')
  }
  next()
  ...
}

```

* config.js è®¾å®šå…¨å±€è·¯ç”±ä¸­é—´ä»¶

```js
vue:{
    ...
    middlewares:['view/middlewares/auth.js'] 
}
```

### èµ„æºæ–‡ä»¶

viteä¸­çš„[é™æ€èµ„æºæœåŠ¡çš„æ–‡ä»¶å¤¹](https://cn.vitejs.dev/config/shared-options.html#publicdir)ï¼ˆé»˜è®¤ plulicï¼‰ä¸‹çš„èµ„ä¼šåœ¨ç¼–è¯‘æ—¶ç›´æ¥æ‹·è´åˆ°è¾“å‡ºæ ¹ç›®å½•ä¸‹ç›´æ¥è®¿é—®ï¼Œæ‰€ä»¥å¼€å‘å’Œç¼–è¯‘æ˜¯éƒ½å¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨. å»ºè®®ä½¿ç”¨çš„æ—¶å€™å¢åŠ ä¸€ä¸ªå‘½åç©ºé—´å­æ–‡ä»¶å¤¹æ›´åŠ æ–¹ä¾¿ç®¡ç†ã€‚æ¯”å¦‚ï¼š

```js
// ç›®å½•
public            // publicDir   é™æ€èµ„æºæœåŠ¡çš„æ–‡ä»¶å¤¹æ ¹ç›®å½•
  -static         // folder
    -img          // folder
      -logo.png   // file
// è®¿é—®
/static/img/logo.png
```